<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.4 Exercises | Business Forecasting</title>
  <meta name="description" content="This is the book description" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4.4 Exercises | Business Forecasting" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the book description" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.4 Exercises | Business Forecasting" />
  
  <meta name="twitter:description" content="This is the book description" />
  

<meta name="author" content="Jonas Ringive Korsholm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="DataPatternsAndModelSelection.html"/>
<link rel="next" href="Methods.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>setup</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="curriculum.html"><a href="curriculum.html"><i class="fa fa-check"></i><b>2</b> Curriculum</a></li>
<li class="chapter" data-level="3" data-path="qualitative-forecasting-methods.html"><a href="qualitative-forecasting-methods.html"><i class="fa fa-check"></i><b>3</b> Qualitative Forecasting Methods</a>
<ul>
<li class="chapter" data-level="3.1" data-path="judgmental-forecasting-and-forecast-adjustments.html"><a href="judgmental-forecasting-and-forecast-adjustments.html"><i class="fa fa-check"></i><b>3.1</b> Judgmental Forecasting and Forecast Adjustments</a></li>
<li class="chapter" data-level="3.2" data-path="articles.html"><a href="articles.html"><i class="fa fa-check"></i><b>3.2</b> Articles</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="articles.html"><a href="articles.html#a-new-product-growth-model-for-consumer-durables-management-science"><i class="fa fa-check"></i><b>3.2.1</b> A new product growth model for consumer durables,” Management Science</a></li>
<li class="chapter" data-level="3.2.2" data-path="articles.html"><a href="articles.html#sales-forecasts-for-existing-consumer-products"><i class="fa fa-check"></i><b>3.2.2</b> Sales Forecasts for Existing Consumer Products</a></li>
<li class="chapter" data-level="3.2.3" data-path="articles.html"><a href="articles.html#judgmental-forecasting-a-review-of-progress-over-the-last-25-years-international-journal-of-forecasting"><i class="fa fa-check"></i><b>3.2.3</b> Judgmental forecasting A review of progress over the last 25 years, International Journal of Forecasting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploring-patterns-and-forecasting-techniques.html"><a href="exploring-patterns-and-forecasting-techniques.html"><i class="fa fa-check"></i><b>4</b> Exploring Patterns and Forecasting Techniques</a>
<ul>
<li class="chapter" data-level="4.1" data-path="the-forecasting-process.html"><a href="the-forecasting-process.html"><i class="fa fa-check"></i><b>4.1</b> The forecasting process</a></li>
<li class="chapter" data-level="4.2" data-path="data-patterns-and-terminology.html"><a href="data-patterns-and-terminology.html"><i class="fa fa-check"></i><b>4.2</b> Data Patterns and terminology</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-patterns-and-terminology.html"><a href="data-patterns-and-terminology.html#terminology"><i class="fa fa-check"></i><b>4.2.1</b> Terminology</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="DataPatternsAndModelSelection.html"><a href="DataPatternsAndModelSelection.html"><i class="fa fa-check"></i><b>4.3</b> Data Patterns and Model Selection</a></li>
<li class="chapter" data-level="4.4" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>4.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="exercises.html"><a href="exercises.html#p.-92-hw-problem-8"><i class="fa fa-check"></i><b>4.4.1</b> p. 92 HW Problem 8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Methods.html"><a href="Methods.html"><i class="fa fa-check"></i><b>5</b> Methods and Performance Measurement</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ForecastMethods.html"><a href="ForecastMethods.html"><i class="fa fa-check"></i><b>5.1</b> Forecasting Methods</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ForecastMethods.html"><a href="ForecastMethods.html#using-averages"><i class="fa fa-check"></i><b>5.1.1</b> Using Averages</a></li>
<li class="chapter" data-level="5.1.2" data-path="ForecastMethods.html"><a href="ForecastMethods.html#linear-regressions"><i class="fa fa-check"></i><b>5.1.2</b> Linear regressions</a></li>
<li class="chapter" data-level="5.1.3" data-path="ForecastMethods.html"><a href="ForecastMethods.html#non-linear-regressions"><i class="fa fa-check"></i><b>5.1.3</b> Non linear regressions</a></li>
<li class="chapter" data-level="5.1.4" data-path="ForecastMethods.html"><a href="ForecastMethods.html#smoothing-methods"><i class="fa fa-check"></i><b>5.1.4</b> Smoothing methods</a></li>
<li class="chapter" data-level="5.1.5" data-path="ForecastMethods.html"><a href="ForecastMethods.html#arima"><i class="fa fa-check"></i><b>5.1.5</b> ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="PerformanceMeasurements.html"><a href="PerformanceMeasurements.html"><i class="fa fa-check"></i><b>5.2</b> Performance Measurements</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Business Forecasting</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercises" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Exercises</h2>
<p><em>This section contain exercises, hence the methods applied on data</em></p>
<div id="p.-92-hw-problem-8" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> p. 92 HW Problem 8</h3>
<div id="moving-averages" class="section level4" number="4.4.1.1">
<h4><span class="header-section-number">4.4.1.1</span> Moving Averages</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="exercises.html#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;Data/Week45/prob8p92HW.xlsx&quot;</span>)</span>
<span id="cb3-2"><a href="exercises.html#cb3-2" aria-hidden="true" tabindex="-1"></a>yt <span class="ot">&lt;-</span> <span class="fu">ts</span>(df) <span class="co">#Rename and define as time series</span></span>
<span id="cb3-3"><a href="exercises.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(yt) <span class="co">#We can plot the</span></span></code></pre></div>
<p><img src="Business-Forecasting-Notebook_files/figure-html/unnamed-chunk-10-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>We see that there is a trend in the data.</p>
<p>We can calculate the five period moving average by:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="exercises.html#cb4-1" aria-hidden="true" tabindex="-1"></a>yt5c <span class="ot">&lt;-</span> <span class="fu">ma</span>(yt <span class="co">#The time series</span></span>
<span id="cb4-2"><a href="exercises.html#cb4-2" aria-hidden="true" tabindex="-1"></a>           ,<span class="at">order =</span> <span class="dv">5</span> <span class="co">#Amount of periods to be evaluated</span></span>
<span id="cb4-3"><a href="exercises.html#cb4-3" aria-hidden="true" tabindex="-1"></a>           ,<span class="at">centre =</span> <span class="cn">TRUE</span> <span class="co">#We want the center value of the MA</span></span>
<span id="cb4-4"><a href="exercises.html#cb4-4" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb4-5"><a href="exercises.html#cb4-5" aria-hidden="true" tabindex="-1"></a>yt5c</span></code></pre></div>
<pre><code>## Time Series:
## Start = 1 
## End = 8 
## Frequency = 1 
##       [,1]
## [1,]    NA
## [2,]    NA
## [3,] 212.0
## [4,] 216.0
## [5,] 219.0
## [6,] 221.2
## [7,]    NA
## [8,]    NA</code></pre>
<p>Hence we are able to produce moving averages based on the data. Notice, that the most recent MA is the prediction, hence being <span class="math inline">\(\hat{Y}_{t+1}\)</span>.</p>
<p>One could extend this, by adding this value to the time series and then calculate MA for the period hereafter. We see that the output of the table above is somewhat misleading, as the most recent MA predictinos, are not positioned in the end, but instead where the center actually is.</p>
<p>This problem is solvable using <code>filter()</code>. See the following chunk</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="exercises.html#cb6-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co">#specify the order of the moving average</span></span>
<span id="cb6-2"><a href="exercises.html#cb6-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">rep</span> (<span class="dv">1</span><span class="sc">/</span>k,k) <span class="co">#remember that simple average is a weighted average with equal weights, </span></span>
<span id="cb6-3"><a href="exercises.html#cb6-3" aria-hidden="true" tabindex="-1"></a>                <span class="co">#you need to specify weights for the filter command to work</span></span>
<span id="cb6-4"><a href="exercises.html#cb6-4" aria-hidden="true" tabindex="-1"></a>yt5<span class="ot">&lt;-</span> <span class="fu">filter</span>(yt, c, <span class="at">sides =</span> <span class="dv">1</span>)</span>
<span id="cb6-5"><a href="exercises.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(yt5)<span class="co"># &quot;Plotting the MA&#39;s</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-12"></span>
<img src="Business-Forecasting-Notebook_files/figure-html/unnamed-chunk-12-1.png" alt="5k Moving Average" width="480" />
<p class="caption">
Figure 4.4: 5k Moving Average
</p>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="exercises.html#cb7-1" aria-hidden="true" tabindex="-1"></a>yt5 <span class="co">#The updated vector of MA&#39;s</span></span></code></pre></div>
<pre><code>## Time Series:
## Start = 1 
## End = 8 
## Frequency = 1 
##       [,1]
## [1,]    NA
## [2,]    NA
## [3,]    NA
## [4,]    NA
## [5,] 212.0
## [6,] 216.0
## [7,] 219.0
## [8,] 221.2</code></pre>
<p>This we see, that scores are moved to the end, so even though it is the center of the MA, it is now presented as recent values.</p>
<p>For simple moving averages, one may do it in excel, it may be easier and quicker.</p>
</div>
<div id="exponential-moving-averages-normal-holts-and-winters" class="section level4" number="4.4.1.2">
<h4><span class="header-section-number">4.4.1.2</span> Exponential moving averages, normal, Holts and Winters</h4>
<p>Simple and Holt-Winters exponential smoothing</p>
<p>Where;</p>
<ul>
<li>alpha is the smoothing parameter,</li>
<li>beta tells you if you should account for a trend or not,</li>
<li>gamma is responsible for the presence of a seasonal component in the model</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="exercises.html#cb9-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(yt</span>
<span id="cb9-2"><a href="exercises.html#cb9-2" aria-hidden="true" tabindex="-1"></a>                   ,<span class="at">alpha =</span> <span class="fl">0.4</span></span>
<span id="cb9-3"><a href="exercises.html#cb9-3" aria-hidden="true" tabindex="-1"></a>                   ,<span class="at">beta =</span> <span class="cn">FALSE</span></span>
<span id="cb9-4"><a href="exercises.html#cb9-4" aria-hidden="true" tabindex="-1"></a>                   ,<span class="at">gamma =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-5"><a href="exercises.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(df))) <span class="sc">+</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>)</span></code></pre></div>
<pre><code>## integer(0)</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="exercises.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span>,<span class="st">&quot;Fitted&quot;</span>),<span class="at">lty =</span> <span class="dv">1</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="Business-Forecasting-Notebook_files/figure-html/unnamed-chunk-13-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Hence we see the smoothed values, where the higher alpha, the more will the fitted line track the changes in the observations.</p>
<p>We can now plot the forecast values:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="exercises.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(fit),<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(df)<span class="sc">+</span><span class="dv">10</span>))<span class="co"># + grid(col = &quot;lightgrey&quot;)</span></span>
<span id="cb12-2"><a href="exercises.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span>,<span class="st">&quot;Forecast&quot;</span>),<span class="at">lty =</span> <span class="dv">1</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;Black&quot;</span>,<span class="st">&quot;Blue&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-14"></span>
<img src="Business-Forecasting-Notebook_files/figure-html/unnamed-chunk-14-1.png" alt="Forecast Exponential Smoothing" width="480" />
<p class="caption">
Figure 4.5: Forecast Exponential Smoothing
</p>
</div>
<p>One see the confidence intervals of the forecast widening as we get further away from the actual values.</p>
<p>Now one may assess the accuracy:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="exercises.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(<span class="fu">forecast</span>(fit))</span></code></pre></div>
<pre><code>##                    ME     RMSE      MAE      MPE     MAPE     MASE      ACF1
## Training set 8.001509 8.209102 8.001509 3.673623 3.673623 2.154252 0.1962194</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="exercises.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>

</div>
</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="DataPatternsAndModelSelection.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
